<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>User</title>
    <style>
        .info {
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;

            .avatar {
                display: block;
                width: 132px;
                height: 132px;
                border-radius: 50%;
            }
            .name {
                font-size: 24px;
            }
        }
    </style>
</head>
<body>
<div class="info">
    <img class="avatar" src="" alt="头像">
    <p class="name"></p>
    <p class="location"></p>
    <p class="desc"></p>
</div>

<a title="打赏支持" class="feedback" href="https://pic.ziyuan.wang/2023/12/03/Silly_aff262eace9c8.jpg" target="_blank">
    <svg data-v-98989b36="" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"
         class="">
        <path data-v-98989b36=""
              d="M3.26628 5.18082C3.26628 4.35104 3.94716 3.67545 4.7907 3.67545H15.2093C16.0528 3.67545 16.7337 4.35104 16.7337 5.18082V12.538C16.7337 13.3678 16.0528 14.0434 15.2093 14.0434H11.6358C11.4624 14.0434 11.2948 14.1064 11.165 14.221L8.28954 16.7575V14.7452C8.28954 14.356 7.97087 14.0434 7.5814 14.0434H4.7907C3.94716 14.0434 3.26628 13.3678 3.26628 12.538V5.18082ZM4.7907 2.27187C3.16822 2.27187 1.85 3.57264 1.85 5.18082V12.538C1.85 14.1462 3.16822 15.447 4.7907 15.447H6.87326V17.5004C6.87326 18.4274 7.97825 18.9111 8.67204 18.2991L11.9053 15.447H15.2093C16.8318 15.447 18.15 14.1462 18.15 12.538V5.18082C18.15 3.57264 16.8318 2.27187 15.2093 2.27187H4.7907Z"
              fill="#1E80FF" stroke="#1E80FF" stroke-width="0.3" stroke-linejoin="round"></path>
        <path data-v-98989b36=""
              d="M7.00132 9.49204C6.79163 9.17668 6.366 9.09101 6.05063 9.3007C5.73527 9.51038 5.6496 9.93602 5.85929 10.2514C6.74878 11.5891 8.27183 12.4732 10.0017 12.4732C11.7316 12.4732 13.2546 11.5891 14.1441 10.2514C14.3538 9.93602 14.2681 9.51038 13.9528 9.3007C13.6374 9.09101 13.2118 9.17668 13.0021 9.49204C12.356 10.4637 11.2532 11.1018 10.0017 11.1018C8.75017 11.1018 7.64741 10.4637 7.00132 9.49204Z"
              fill="#1E80FF" stroke="#1E80FF" stroke-width="0.3" stroke-linecap="round" stroke-linejoin="round"></path>
    </svg>
</a>

<script>
    function gotoLogin() {
        localStorage.removeItem('token')
        window.location.href = '/login.html'
    }

    function fetchUserInfo() {
        const token = localStorage.getItem('token')
        if (!token) {
            gotoLogin()
            return
        }

        fetch('/api/user/info', {
            headers: {
                token: token,
            }
        }).then(resp => resp.json()).then(resp => {
            const {code, data, msg} = resp
            if (code === 2) {
                gotoLogin()
                return
            } else if (code !== 0) {
                alert(msg)
                return
            }

            const {avatar, name, vDesc, location} = data
            document.querySelector('.avatar').src = avatar
            document.querySelector('.name').textContent = name
            document.querySelector('.desc').textContent = vDesc
            document.querySelector('.location').textContent = location
        })
    }

    window.addEventListener('DOMContentLoaded', fetchUserInfo)
</script>
</body>
</html>
